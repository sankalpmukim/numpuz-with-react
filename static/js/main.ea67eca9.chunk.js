(this["webpackJsonpnumpuz-with-react"]=this["webpackJsonpnumpuz-with-react"]||[]).push([[0],{15:function(e,t,r){},16:function(e,t,r){},33:function(e,t,r){},41:function(e,t,r){"use strict";r.r(t);var n=r(4),c=r.n(n),i=r(23),a=r.n(i),s=(r(16),r(8)),o=(r(33),r(2)),l=function(e){return Object(o.jsx)("div",{className:"square",onClick:function(){return e.onClick()},children:e.value})},u=function(e){var t=e.squares.slice();return t=t.map((function(r,n){return Object(o.jsx)(l,{onClick:function(){return e.squareClick(n)},value:t[n]},t[n])})),Object(o.jsx)("div",{className:"board",style:{"--grid-size":e.gridSize},children:t})},d=r(14),j=function(e){var t=e.won,r=e.user,c=e.gridSize,i=e.isActive,a=e.reset,l=e.setReset,u=e.firestore,j=e.firebase,f=Object(n.useState)(0),b=Object(s.a)(f,2),O=b[0],h=b[1];return Object(n.useEffect)((function(){a&&(l(!1),h(0))}),[a,l]),Object(n.useEffect)((function(){var e=null;return i?e=setInterval((function(){h((function(e){return e+100}))}),100):clearInterval(e),function(){clearInterval(e)}}),[i]),Object(n.useEffect)((function(){if(t&&r)if(console.log(r.uid),null!==localStorage.getItem(c)){if(console.log("won"),"undefined"===typeof JSON.parse(localStorage.getItem(c))[r.uid]||"undefined"!==typeof JSON.parse(localStorage.getItem(c))[r.uid]&&JSON.parse(localStorage.getItem(c))[r.uid]>O){var e=Object(d.a)({},JSON.parse(localStorage.getItem(c)));e[r.uid]=O,localStorage.setItem(c,JSON.stringify(e))}}else{var n={};n[r.uid]=O,localStorage.setItem(c,JSON.stringify(n))}}),[t,r,O,c]),Object(n.useEffect)((function(){if(t&&r){console.log(r.uid);var e=u.collection(String(c)).doc(r.uid);if(e.get().then((function(t){t.exists?t.data().score>O&&e.update({createdAt:j.firestore.FieldValue.serverTimestamp(),score:O}):e.set({uid:r.uid,createdAt:j.firestore.FieldValue.serverTimestamp(),userName:r.displayName,photoUrl:r.photoURL,score:O})})),null!==localStorage.getItem(c)){if(console.log("won"),"undefined"===typeof JSON.parse(localStorage.getItem(c))[r.uid]||"undefined"!==typeof JSON.parse(localStorage.getItem(c))[r.uid]&&JSON.parse(localStorage.getItem(c))[r.uid]>O){var n=Object(d.a)({},JSON.parse(localStorage.getItem(c)));n[r.uid]=O,localStorage.setItem(c,JSON.stringify(n))}}else{var i={};i[r.uid]=O,localStorage.setItem(c,JSON.stringify(i))}}}),[t,r,O,c,u]),Object(o.jsxs)("div",{className:"timer",children:[Object(o.jsxs)("span",{className:"digits",children:[("0"+Math.floor(O/6e4%60)).slice(-2),":"]}),Object(o.jsxs)("span",{className:"digits",children:[("0"+Math.floor(O/1e3%60)).slice(-2),"."]}),Object(o.jsx)("span",{className:"digits mili-sec",children:("0"+O/10%100).slice(-2)})]})},f=r(11),b=r(12);f.a.initializeApp({apiKey:"AIzaSyDBixDXHM4NCrY27GGRPP3X7SozpeUNjzw",authDomain:"numpuz-c8a36.firebaseapp.com",projectId:"numpuz-c8a36",storageBucket:"numpuz-c8a36.appspot.com",messagingSenderId:"188829020133",appId:"1:188829020133:web:5b1c6f9c42aea6c584c90c",measurementId:"G-J8LHBKCHE8"});var O=c.a.createContext();O.displayName="Store";var h=function(){return c.a.useContext(O)},m=function(e){var t=e.children,r=e.initialState,n=e.reducer,i=c.a.useReducer(n,r),a=Object(s.a)(i,2),l=a[0],u=a[1];return Object(o.jsx)(O.Provider,{value:[l,u],children:t})},g=(r(39),r(40),"APP/AUTH/LOGIN"),x="APP/AUTH/LOGOUT",p={user:null,auth:f.a.auth(),firestore:f.a.firestore()},v=(r(15),function(){var e=h(),t=Object(s.a)(e,2),r=t[0].auth,n=t[1],c=Object(b.a)(r),i=Object(s.a)(c,1)[0];return Object(o.jsxs)("div",{className:"leaderboard full",children:[Object(o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(o.jsx)("button",{className:"sign-in",onClick:function(){var e=new f.a.auth.GoogleAuthProvider;r.signInWithPopup(e),n(function(e){return{type:g,payload:e}}(i))},children:"Sign in with Google"})}),Object(o.jsx)("p",{children:"Do not violate the community guidelines or you will be banned for life!"})]})}),S=function(){var e=h(),t=Object(s.a)(e,2),r=t[0].auth,n=t[1];return r.currentUser&&Object(o.jsx)("button",{className:"sign-out",onClick:function(){n({type:x}),r.signOut()},children:"Sign Out"})},y=r(24),N=function(e){return Object(o.jsxs)("td",{children:[Object(o.jsxs)("span",{className:"time score",children:[("0"+Math.floor(e.time/6e4%60)).slice(-2),":"]}),Object(o.jsxs)("span",{className:"time score",children:[("0"+Math.floor(e.time/1e3%60)).slice(-2),"."]}),Object(o.jsx)("span",{className:"time mili-sec score",children:("0"+e.time/10%100).slice(-2)})]})},w=function(e){var t=h(),r=Object(s.a)(t,1)[0].auth.currentUser.uid,n=e.document,c=n.userName,i=n.score,a=n.photoUrl,l=r===n.uid?"current-user":"";return Object(o.jsxs)("tr",{className:l,children:[Object(o.jsx)("td",{colSpan:"1",children:e.rank}),Object(o.jsx)("td",{colSpan:"1",style:{width:"4rem"},children:Object(o.jsx)("img",{src:a,alt:c+"'s photo.",className:"image"})}),Object(o.jsx)("td",{colSpan:"1",children:c}),Object(o.jsx)(N,{time:i})]})},I=Object(n.forwardRef)((function(e,t){var r=h(),n=Object(s.a)(r,1)[0].auth.currentUser.uid,c=e.document,i=c.userName,a=c.score,l=c.photoUrl,u=n===c.uid?"current-user":"";return Object(o.jsxs)("tr",{ref:t,className:u,children:[Object(o.jsx)("td",{colSpan:"1",children:e.rank}),Object(o.jsx)("td",{colSpan:"1",style:{width:"4rem"},children:Object(o.jsx)("img",{src:l,alt:i+"'s photo.",className:"image"})}),Object(o.jsx)("td",{colSpan:"1",children:i}),Object(o.jsx)(N,{time:a})]})})),k=r(25),z=r(26),C=r(28),E=r(27),A=function(e){Object(C.a)(r,e);var t=Object(E.a)(r);function r(){return Object(k.a)(this,r),t.apply(this,arguments)}return Object(z.a)(r,[{key:"render",value:function(){return Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"#"}),Object(o.jsx)("th",{style:{width:"4rem"},children:"Image"}),Object(o.jsx)("th",{children:"Username"}),Object(o.jsx)("th",{children:"Best Score"})]})})}}]),r}(n.Component),J=function(e){var t=h(),r=Object(s.a)(t,1)[0],c=r.auth,i=r.firestore,a=Object(b.a)(c),l=Object(s.a)(a,1)[0],u=i.collection(String(e.gridSize)).orderBy("score","asc"),d=Object(y.a)(u,{idField:"uid"}),j=Object(s.a)(d,1)[0],f=Object(n.useState)(!0),O=Object(s.a)(f,2),m=O[0],g=O[1],x=Object(n.createRef)(),p=Object(n.createRef)();return l&&Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(o.jsxs)("table",{className:"table-container",children:[Object(o.jsx)(A,{}),Object(o.jsx)("tbody",{children:j&&j.map((function(e,t){return 0===t?Object(o.jsx)(I,{document:e,rank:t+1,ref:x},e.uid):e.uid!==l.uid?Object(o.jsx)(w,{document:e,rank:t+1},e.uid):Object(o.jsx)(I,{document:e,rank:t+1,ref:p},e.uid)}))})]})}),Object(o.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(o.jsx)("button",{onClick:function(e){m?(null!==p.current&&p.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),g(!1)):(x.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),g(!0))},children:m?"Scroll to you":"Scroll to top"})})]})},R=function(e){return Object(o.jsxs)("div",{className:"leaderboard full",children:[Object(o.jsxs)("div",{className:"full",children:[Object(o.jsxs)("div",{className:"full",children:["You are logged in as ",e.user.displayName]}),Object(o.jsx)(S,{})]}),Object(o.jsx)(J,{gridSize:e.gridSize})]})},P=function(e){var t=h(),r=Object(s.a)(t,1)[0].auth,n=Object(b.a)(r),c=Object(s.a)(n,1)[0];return c?Object(o.jsx)(R,{user:c,gridSize:e.gridSize}):Object(o.jsx)(v,{})},U=function(e){var t=Array.from({length:e*e},(function(e,t){return String(t+1)}));return t[t.length-1]="##",t.sort((function(){return Math.random()-.5})),t},G=function(e,t,r){var n=e[t];return e[t]=e[r],e[r]=n,e},M=function(e,t){var r=function(e,t){for(var r=0,n=0;n<t*t-1;n++)for(var c=n+1;c<t*t;c++)e[n]>e[c]&&0!==e[n]&&0!==e[c]&&r++;return r}(e=e.map((function(e){return"##"===e?0:Number(e)})),t);return t%2===1?(console.log("Odd grid:",r%2===0),r%2===0):function(e,t){for(var r=t-1;r>=0;r--)for(var n=t-1;n>=0;n--)if(0===e[r][n])return t-r}(function(e,t){for(var r=new Array(t),n=0;n<r.length;n++)r[n]=new Array(t);for(var c=0;c<r.length;c++)for(var i=0;i<r[c].length;i++)r[c][i]=e[c*t+i];return r}(e,t),t)%2===1?(console.log("Even grid:",r%2===0),r%2===0):(console.log("Even grid:",r%2===1),r%2===1)},D=function(e){for(var t=U(e),r=0;!1===M(t,e);)r++,t=U(e);return console.log("It took this many re generations",r),console.log(t),console.trace("generateInitArray"),t},q=function(){var e=Object(n.useState)(4),t=Object(s.a)(e,2),r=t[0],c=t[1],i=D(r),a=Object(n.useState)(i),l=Object(s.a)(a,2),d=l[0],O=l[1],m=Object(n.useState)(!1),g=Object(s.a)(m,2),x=g[0],p=g[1],v=Object(n.useState)(!1),S=Object(s.a)(v,2),y=S[0],N=S[1],w=Object(n.useState)(!1),I=Object(s.a)(w,2),k=I[0],z=I[1],C=h(),E=Object(s.a)(C,1)[0],A=E.auth,J=E.firestore,R=Object(b.a)(A),U=Object(s.a)(R,1)[0],M=Object(n.useState)(!0),q=Object(s.a)(M,2),B=q[0],F=q[1];Object(n.useEffect)((function(){B?(document.documentElement.style.setProperty("--bg-color","rgb(47,47,47)"),document.documentElement.style.setProperty("--main-color","white")):(document.documentElement.style.setProperty("--bg-color","white"),document.documentElement.style.setProperty("--main-color","rgb(47,47,47)"))}),[B]),Object(n.useEffect)((function(){r<2||r>10?(alert("Gridsize can only be between 2 and 10!"),c(4)):(z(!0),O((function(e){return D(r)})),N(!1))}),[r]),Object(n.useEffect)((function(){null===U&&(O((function(e){return D(r)})),N(!1),p(!1))}),[U,r]),Object(n.useEffect)((function(){var e=d.slice();if(-1!==e.indexOf("##")){var t=Math.sqrt(e.length),r=Array.from({length:t*t},(function(e,t){return String(t+1)}));if(e[e.indexOf("##")]=String(e.length),function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(e,r))return console.log("Game won"),N(!1),void p(!0);p(!1)}else p(!0)}),[d]),Object(n.useEffect)((function(){x&&(alert("Congratulations!! You have won the game!"),null===U&&alert("Represent your score on the global leaderboard by logging in!"))}),[x,U]);var H=function(e){var t=d.indexOf("##");if(e===t)return 0;if(e%r===t%r)return 1;var n=t-t%r;return e>=n&&e<=n+r-1?-1:0};return Object(o.jsxs)("div",{style:{"--bg-color":B?"rgb(47,47,47)":"white","--main-color":B?"white":"rgb(47,47,47)",backgroundColor:"var(--bg-color)",color:"var(--main-color)"},children:[Object(o.jsx)("h1",{children:"Number puzzle!"}),Object(o.jsxs)("div",{className:"game",children:[Object(o.jsx)(u,{squares:d,gridSize:r,squareClick:function(e){y||!1!==x||(N(!0),z(!0)),0!==H(e)&&!1===x&&(1===H(e)?function(e,t){var n=d.slice();if(e<t)for(;n.indexOf("##")!==e;)n=G(n,n.indexOf("##"),n.indexOf("##")-r);else if(e>t)for(;n.indexOf("##")!==e;)n=G(n,n.indexOf("##"),n.indexOf("##")+r);O(n)}(e,d.indexOf("##")):function(e,t){var r=d.slice();if(e<t)for(;r.indexOf("##")!==e;)r=G(r,r.indexOf("##"),r.indexOf("##")-1);else if(e>t)for(;r.indexOf("##")!==e;)r=G(r,r.indexOf("##"),r.indexOf("##")+1);O(r)}(e,d.indexOf("##")))}}),Object(o.jsxs)("div",{className:"details",children:[Object(o.jsx)("label",{htmlFor:"number",children:Object(o.jsxs)("h3",{className:"grid-size",children:[Object(o.jsx)("span",{className:"child-1",children:"Decide grid size:"}),Object(o.jsx)("span",{className:"child-1",children:r}),Object(o.jsx)("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",onClick:function(){c((function(e){return e+1}))},style:{color:"var(--main-color)"},children:Object(o.jsx)("path",{d:"M23.245 20l-11.245-14.374-11.219 14.374-.781-.619 12-15.381 12 15.391-.755.609z"})}),Object(o.jsx)("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",onClick:function(){c((function(e){return e-1}))},children:Object(o.jsx)("path",{d:"M23.245 4l-11.245 14.374-11.219-14.374-.781.619 12 15.381 12-15.391-.755-.609z"})})]})}),Object(o.jsx)("div",{children:Object(o.jsx)("h3",{children:x?"Game won":"Game not won"})}),Object(o.jsxs)("div",{children:[Object(o.jsx)("input",{id:"dark-mode",type:"checkbox",checked:B,onChange:function(e){return F((function(e){return!e}))}}),Object(o.jsx)("label",{htmlFor:"dark-mode",children:"Enable Dark Mode"})]}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{className:"my-button",onClick:function(){O((function(e){return D(r)})),N(!1),p(!1),z(!0)},children:"Reset board"})}),Object(o.jsx)(j,{reset:k,setReset:z,won:x,user:U,gridSize:r,isActive:y,firebase:f.a,firestore:J}),Object(o.jsx)(P,{gridSize:r})]})]})]})};a.a.render(Object(o.jsx)(c.a.StrictMode,{children:Object(o.jsx)(m,{initialState:p,reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,r={};switch(t.type){case g:r=Object(d.a)(Object(d.a)({},e),{},{user:t.payload});break;case x:r=Object(d.a)(Object(d.a)({},e),{},{user:null});break;default:throw new Error("Invalid Dispatch operation")}return r},children:Object(o.jsx)(q,{})})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.ea67eca9.chunk.js.map